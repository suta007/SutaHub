--!strict
-- SutaHub Bootstrapper (loader.luau)

-- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î Type ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Config ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏Ñ‡πà‡∏∞
type SutaConfig = {
	Owner: string,
	Repo: string,
	Branch: string,
	BaseUrl: string,
	Version: string,
}

local CONFIG = {
	Owner = "suta007",
	Repo = "SutaHub",
	Branch = "master",
}

-- ‡πÉ‡∏ä‡πâ String Interpolation ‡πÅ‡∏ö‡∏ö Luau ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠ URL
local baseUrl: string = `https://raw.githubusercontent.com/{CONFIG.Owner}/{CONFIG.Repo}/{CONFIG.Branch}/`

-- ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å getgenv() ‡πÄ‡∏õ‡πá‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡∏≠‡∏á Executor ‡∏ô‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏¢‡πÉ‡∏ä‡πâ type any ‡∏î‡∏±‡∏Å‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ strict mode ‡πÇ‡∏ß‡∏¢‡∏ß‡∏≤‡∏¢‡∏Ñ‡πà‡∏∞

env.SutaHubConfig = {
	BaseUrl = baseUrl,
	Version = "0.0.1",
} :: SutaConfig -- ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö Cast Type ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÑ‡∏ß‡πâ

local envUrl: string = `{baseUrl}src/env.luau`

local success: boolean, result: any = pcall(function(): string
	return game:HttpGet(envUrl)
end)

repeat
	task.wait()
until getgenv().EF_Script

print("üå± SutaHub: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≤‡∏Å GitHub...")

local githubUtilUrl: string = `{baseUrl}src/utils/github.luau`

local success: boolean, result: any = pcall(function(): string
	return game:HttpGet(githubUtilUrl)
end)

if success and type(result) == "string" then
	local func, compileErr = loadstring(result)

	if func then
		local GitHub = func()
		-- ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÑ‡∏ü‡∏•‡πå main.luau ‡∏ï‡πà‡∏≠‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞
		GitHub.require("src/main.luau")
	else
		warn(`‚ùå SutaHub [Compile Error]: {compileErr}`)
	end
else
	warn(
		"‚ùå SutaHub [Error]: ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ GitHub ‡πÑ‡∏î‡πâ ‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏ä‡πá‡∏Å‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï‡∏´‡∏£‡∏∑‡∏≠ URL ‡∏Ñ‡πà‡∏∞"
	)
end
