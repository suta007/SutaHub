--!strict
-- src/main.luau

print("üöÄ SutaHub: ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏Å (Main) ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞‡∏û‡∏µ‡πà‡πÄ‡∏≠‡∏ü!")

local env: any = getgenv and getgenv() or shared
local config = env.SutaHubConfig

if not config or type(config.BaseUrl) ~= "string" then
    error("‚ùå SutaHub [Error]: ‡πÑ‡∏°‡πà‡∏û‡∏ö BaseUrl ‡∏Ñ‡πà‡∏∞ ‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏£‡∏±‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ú‡πà‡∏≤‡∏ô loader.luau ‡∏ô‡∏∞‡∏Ñ‡∏∞")
end

-- 1. ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏°‡∏î‡∏π‡∏• GitHub ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå
local githubUrl: string = `{config.BaseUrl}src/utils/github.luau`
local GitHub = loadstring(game:HttpGet(githubUrl))()

print("üé® SutaHub: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á UI...")

-- 2. ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å (Window) ‡∏à‡∏≤‡∏Å Fluent Renewed
-- ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ return object ‡∏Ç‡∏≠‡∏á Window ‡πÅ‡∏•‡∏∞ Library ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤
local GUI = GitHub.require("src/gui/window.luau")
local Window = GUI.Window
local Fluent = GUI.Library

-- 3. ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Addons (Component Hooking)
-- ‡∏™‡πà‡∏á Library ‡∏Ç‡∏≠‡∏á Fluent ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Addon ‡πÅ‡∏ó‡∏£‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏£‡πâ‡∏≤‡∏á CollapsibleSection ‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏∞
local Addons = GitHub.require("src/gui/addons.luau")
Addons.install(Fluent)

-- 4. ‡πÇ‡∏´‡∏•‡∏î Tabs ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á UI
-- ‡∏™‡πà‡∏á Window ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏ï‡πà‡∏•‡∏∞ Tab ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏≠‡∏≤ UI ‡πÑ‡∏õ‡∏ß‡∏≤‡∏î‡∏•‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô
local FarmTab = GitHub.require("src/gui/tabs/farm_tab.luau")
FarmTab.init(Window, Fluent)

local SettingTab = GitHub.require("src/gui/tabs/setting_tab.luau")
SettingTab.init(Window, Fluent)

print("‚öôÔ∏è SutaHub: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏ü‡∏≤‡∏£‡πå‡∏°‡πÅ‡∏•‡∏∞‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå...")

-- 5. ‡πÇ‡∏´‡∏•‡∏î Features (Logic ‡πÄ‡∏Å‡∏° Grow a Garden)
local AutoFarm = GitHub.require("src/features/auto_farm.luau")
local Motion = GitHub.require("src/features/motion.luau")

-- 6. ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ UI ‡∏Å‡∏±‡∏ö Logic ‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô (Event Binding)
-- ‡∏£‡∏≠‡∏£‡∏±‡∏ö Event ‡∏à‡∏≤‡∏Å UI ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏û‡∏µ‡πà‡πÄ‡∏≠‡∏ü‡∏Å‡∏î‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏ü‡∏≤‡∏£‡πå‡∏°
FarmTab.onToggleFarm(function(isFarming: boolean)
    if isFarming then
        -- ‡∏™‡πà‡∏á Module ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà (Motion) ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏ü‡∏≤‡∏£‡πå‡∏°‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô
        AutoFarm.start(Motion)
    else
        AutoFarm.stop()
    end
end)

print("‚úÖ SutaHub: ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏•‡∏∏‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞!")

-- ‡∏™‡∏±‡πà‡∏á‡πÅ‡∏™‡∏î‡∏á Notification ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
if Fluent and Fluent.Notify then
    Fluent:Notify({
        Title = "SutaHub",
        Content = `‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô {config.Version} ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞‡∏û‡∏µ‡πà‡πÄ‡∏≠‡∏ü!`,
        Duration = 5
    })
end